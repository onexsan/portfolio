(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{358:function(e,t){},391:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-field"},[e._m(0),r("div",{staticClass:"edit-field__form"},[r("form",{staticClass:"review-form",on:{submit:function(t){return t.preventDefault(),e.addReviewCard(e.newReview)},reset:function(t){return t.preventDefault(),e.hideAddingCard(t)}}},[r("div",{staticClass:"review-form__container"},[r("div",{staticClass:"review-form__column"},[r("div",{staticClass:"review-form__image"},[r("div",{staticClass:"add-image"},[r("div",{staticClass:"add-image__icon",class:{hidden:e.renderedPhoto.length},style:e.renderedBackground}),r("input",{staticClass:"add-image__input",attrs:{type:"file",name:"reviews-image",id:"reviews-image"},on:{change:e.addPhoto}}),r("label",{staticClass:"add-image__label",attrs:{for:"reviews-image"}},[e._v("Добавить фото")]),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.photo")}})],1)])]),r("div",{staticClass:"review-form__column"},[r("div",{staticClass:"review-form-row"},[r("div",{staticClass:"review-form-row__block"},[r("label",{staticClass:"form__label",attrs:{for:"author-name"}},[e._v("Имя автора")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newReview.author,expression:"newReview.author"}],staticClass:"form__input",attrs:{type:"text",name:"name",id:"author-name",placeholder:"Ковальчук Дмитрий"},domProps:{value:e.newReview.author},on:{input:function(t){t.target.composing||e.$set(e.newReview,"author",t.target.value)}}}),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.author")}})],1),r("div",{staticClass:"review-form-row__block"},[r("label",{staticClass:"form__label",attrs:{for:"author-desc"}},[e._v("Титул автора")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newReview.occ,expression:"newReview.occ"}],staticClass:"form__input",attrs:{type:"text",name:"desc",id:"author-desc",placeholder:"Основатель LoftSchool"},domProps:{value:e.newReview.occ},on:{input:function(t){t.target.composing||e.$set(e.newReview,"occ",t.target.value)}}}),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.occ")}})],1)]),r("div",{staticClass:"review-form-row"},[r("div",{staticClass:"review-form-row__block review-form-row__block--textarea"},[r("label",{staticClass:"form__label form__label--textarea",attrs:{for:"review-text"}},[e._v("Описание")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newReview.text,expression:"newReview.text"}],staticClass:"form__input form__input--textarea",attrs:{name:"text",id:"review-text",placeholder:"Текст отзыва"},domProps:{value:e.newReview.text},on:{input:function(t){t.target.composing||e.$set(e.newReview,"text",t.target.value)}}}),r("tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.text")}})],1)]),e._m(1)])])])])])};i._withStripped=!0;var a=r(93),n=r(356),o=r.n(n);function s(e,t,r,i,a,n,o){try{var s=e[n](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,a)}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){l(e,t,r[t])})}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=o.a.Validator,d={mixins:[o.a.mixin],props:{review:Object},components:{tooltipInput:function(){return r.e(0).then(r.bind(null,387))}},data:function(){return{renderedPhoto:"",newReview:c({},this.review)}},validators:{"newReview.author":function(e){return v.value(e).required("Добавьте имя")},"newReview.occ":function(e){return v.value(e).required("Добавьте титул")},"newReview.text":function(e){return v.value(e).required("Заполните отзыв")},"newReview.photo":function(e){return v.value(e).required("Добавьте фото")}},methods:c({},Object(a.b)("reviews",["addReview","updateReview"]),Object(a.b)("tooltip",["showTooltip"]),{hideAddingCard:function(){this.$emit("hideAddingCard")},addPhoto:function(e){var t=this;this.newReview.photo=e.target.files[0];var r=new FileReader;try{r.readAsDataURL(this.newReview.photo),r.onload=function(){t.renderedPhoto=r.result}}catch(e){}},addReviewCard:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$validate();case 2:if(!e.sent){e.next=23;break}if(e.prev=3,!Object.keys(this.newReview).some(function(e){return i.newReview[e]!==i.review[e]})){e.next=13;break}if(!t.id){e.next=11;break}return e.next=9,this.updateReview(t);case 9:e.next=13;break;case 11:return e.next=13,this.addReview(t);case 13:this.showTooltip({type:"success",message:"Отзыв успешно добавлен"}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),r=e.t0.message,this.showTooltip({type:"error",message:r});case 20:return e.prev=20,this.$emit("hideAddingCard"),e.finish(20);case 23:case"end":return e.stop()}},e,this,[[3,16,20,23]])}),function(){var t=this,r=arguments;return new Promise(function(i,a){var n=e.apply(t,r);function o(e){s(n,i,a,o,c,"next",e)}function c(e){s(n,i,a,o,c,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()}),computed:c({},Object(a.c)("reviews",["getReviews"]),{renderedBackground:function(){return this.renderedPhoto?"background-image: url(".concat(this.renderedPhoto,");"):""}}),created:function(){this.newReview=c({},this.review),this.review.photo&&(this.renderedPhoto="https://webdev-api.loftschool.com/"+this.review.photo)},watch:{review:function(){console.log("watch"),this.newReview=c({},this.review),this.renderedPhoto="https://webdev-api.loftschool.com/"+this.review.photo}}},u=(r(363),r(92)),w=Object(u.a)(d,i,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit-field__intro"},[t("h3",{staticClass:"review-form__title"},[this._v("Новый отзыв")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"review-form-row review-form-row--btns"},[t("button",{staticClass:"cancel-btn",attrs:{type:"reset"}},[this._v("Отмена")]),t("button",{staticClass:"form-btn",attrs:{type:"submit"}},[this._v("Сохранить")])])}],!1,null,null,null);w.options.__file="src/admin/pages/reviews/reviews-add-new.vue";t.default=w.exports}}]);